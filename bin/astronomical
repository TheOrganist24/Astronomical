#!/usr/bin/env python3


import getopt
import inspect
import sys
import astronomical
from astronomical.interfaces.cli_arguments import (
    Sun,
    Alarms,
    Time
)


# help, usage , and docs
usage = f"Usage: {astronomical.__name__} [OPTION]..."
doc_summary = astronomical.__doc__.split("\n")[0]
arguments = {
    "version": "Output version information and exit.",
    "help": "Display this help and exit.",
    "sun": Sun.__doc__,
    "alarms": Alarms.__doc__,
    "time": Time.__doc__
}
arg_str = ""
for argument, summary in arguments.items():
    arg_str += f"  -{argument[0]}, --{argument}\t{summary}\n"
help = f"{usage}\n\n{doc_summary}\n\n{arg_str}"

short_opts = "".join([arg[0] for arg in arguments])
long_opts = [arg for arg in arguments]


def main(argv):
    try:
        opts, args = getopt.getopt(argv, short_opts, long_opts)
    except getopt.GetoptError:
        print(usage)
        sys.exit(2)
    for opt, arg in opts:
        # standard functions
        if opt in ("-v", "--version"):
            print(astronomical.__version__)
            sys.exit(0)
        elif opt in ("-h", "--help"):
            # print out help content
            print(help)
            sys.exit(0)
        # core functions
        elif opt in ("-s", "--sun"):
            # print out sun facts: rise/set, elevation/azmituh, distance
            print("sun")
        elif opt in ("-t", "--time"):
            # print out time facts: Current time, TO24 time
            print("time")
        elif opt in ("-a", "--alarms"):
            # print out alarms for tonight and tomorrow morning
            print("alarms")


if __name__ == "__main__":
    main(sys.argv[1:])
